---
# Storage Assessment Tasks
# Consolidated platform-agnostic storage space assessment

- name: Platform-agnostic storage assessment
  ansible.builtin.include_tasks: platform-assessment.yml

- name: Calculate storage metrics
  ansible.builtin.set_fact:
    storage_info: >-
      {{ storage_info | combine({
        'used_space_gb': storage_info.total_space_gb
          - storage_info.free_space_gb,
        'usage_percentage': ((storage_info.total_space_gb
          - storage_info.free_space_gb) / storage_info.total_space_gb * 100)
          | round(1)
      }) }}
  when: storage_info.total_space_gb > 0
